<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>静态文件和非静态文件 | 她说</title>
    <meta name="description" content="我的个人网站">
    <link rel="icon" href="/img/meat.ico">
    
    <link rel="preload" href="/assets/css/0.styles.2e32879c.css" as="style"><link rel="preload" href="/assets/js/app.d72ea573.js" as="script"><link rel="preload" href="/assets/js/5.452037c8.js" as="script"><link rel="prefetch" href="/assets/js/2.3b9d6b7b.js"><link rel="prefetch" href="/assets/js/3.d2293747.js"><link rel="prefetch" href="/assets/js/4.9953e9d4.js"><link rel="prefetch" href="/assets/js/6.081a2e41.js"><link rel="prefetch" href="/assets/js/7.e7631b49.js"><link rel="prefetch" href="/assets/js/8.dde3f876.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2e32879c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="她说" class="logo"> <span class="site-name can-hide">她说</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="https://github.com/tashuobutianhei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="https://github.com/tashuobutianhei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>vue学习</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Front/docVue/vue.html" class="sidebar-link">vue源码分析</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>前端部署</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Front/docfront/bushu.html" class="active sidebar-link">静态文件和非静态文件</a></li><li><a href="/Front/docfront/fenli.html" class="sidebar-link">记录一下前后端分离的知识</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>计算机网络知识</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Front/docNet/net.html" class="sidebar-link">网络模型</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p>不谈cdn的前端部署，应该没有什么好谈的，买一个云服务器，前端代码写好后，打包好后直接拖到机器上就可以了，当然这样也是有很多可以优化的点(先不提)。记录一下有cdn，多服务器的情况下时怎么部署的吧。</p> <h4 id="静态文件和非静态文件"><a href="#静态文件和非静态文件" aria-hidden="true" class="header-anchor">#</a> 静态文件和非静态文件</h4> <p>静态资源：就是前端的文件，可能是一个index.html，然后引入一堆打包好后的js,css,public之类的东西，也可以是一个前端启的服务，总之是前端自身控制的，不依赖后端生成的前端资源。</p> <p>非静态资源：是后端通过jsp或者模版拼接出的模板，或者是SSR出来的前端文件，这就是非静态资源。</p> <p>独立的静态文件：和静态资源不同的是功能，这个部分可能是图片，可能是vue，react打包好后的js文件，可能是为css文件来自不同的cdn服务，存储加速嘛。</p> <h4 id="为什么要区分静态和非静态"><a href="#为什么要区分静态和非静态" aria-hidden="true" class="header-anchor">#</a> 为什么要区分静态和非静态</h4> <p>如果是非静态资源就是由后端去拼接，这种部署只需要对后端服务部署，然后拉取cdn需要的静态文件即可。所以对于部署上在于后端服务的部署，我就不说了，我也不会呀。</p> <h4 id="前端部署："><a href="#前端部署：" aria-hidden="true" class="header-anchor">#</a> 前端部署：</h4> <p>简单来说就是基于随机字符串的非覆盖式部署。好吧有点绕，分开说吧。</p> <h5 id="_1-随机字符串：md5或者其他方式生产一个字符串（版本号）"><a href="#_1-随机字符串：md5或者其他方式生产一个字符串（版本号）" aria-hidden="true" class="header-anchor">#</a> 1. 随机字符串：md5或者其他方式生产一个字符串（版本号）</h5> <p>对于一分前端文件，由html，js，css三部分构成，但是每次都请求一次js,css就很花费时间，我们这时候要选择的就是缓存js，css这些静态文件，这样就不用每次都去请求了。但是事实不是这样简单的，因为我们的静态文件是会改的呀，那么我们如何在我们更新的时候去更新缓存地址呐？</p> <p>这就出现了版本号的问题，我们只要给没有静态文件一个版本就好了，当我们更新了静态文件后，更新版本，在html也更换相应的版本就好了。那和随机数有什么关系呐？我们如果使用     v_1,v_1.1,v_1.2这样的版本就会有一个问题，我们的js版本可能改的比较频繁，一下子十几个版本就过去了，但是css可能写好页面后就不动了，这样子版本管理就很乱了，所以这时候就用我们的随机数了，我们放弃版本管理，使用随机数，没次修改完都用随机数生成一个所谓的版本号，这就好了。</p> <h5 id="_2-非覆盖式部署"><a href="#_2-非覆盖式部署" aria-hidden="true" class="header-anchor">#</a> 2. 非覆盖式部署</h5> <p>要说非覆盖部署就得有覆盖部署，然后对比的结果就是使用非覆盖部署，所以先说一下<em>覆盖式部署</em>吧。</p> <p>试想一下在公司业务中一般不会是一台机器，一台cdn服务的，一般都是多台机器，使用负载均衡进行分布式部署。部署的时候，每一次的升级，都会把我们的前端html放在我们的实例服务上，而把静态资源放在cdn上。
这样就会在发布的时候出现一个问题，有多台机器假设有n台，我们采用覆盖式发布就是将新的资源覆盖旧的资源，可是这个覆盖以后会怎么样。因为我们的服务在多台机器上，就总会因为时间的差别，导致有机器的html找不到旧的静态资源，而导致挂站，虽然这个时间间隔很短但是对于项目来说，挂一个和挂多个是没区别的。所以就引出 <em>非覆盖式部署</em></p> <p>非覆盖式部署的意思就是：当我发布一个新的静态文件的时候，不影响之前的静态文件，两者并存，这个那些引用着原先的静态文件的服务也不会挂掉，当这些服务都更新好后自然引入的都是新的静态文件了。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Front/docVue/vue.html" class="prev">
          vue源码分析
        </a></span> <span class="next"><a href="/Front/docfront/fenli.html">
          记录一下前后端分离的知识
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.d72ea573.js" defer></script><script src="/assets/js/5.452037c8.js" defer></script>
  </body>
</html>
